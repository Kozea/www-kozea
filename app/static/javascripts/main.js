// Generated by CoffeeScript 1.6.3
var lock_scroll, unlock_scroll;

$(function() {
  var lock, position, slider;
  position = $("#switch");
  if ($(document).scrollTop() > position.offset().top + position.height()) {
    $("#main-menu").addClass('fixed');
  }
  $('.nav li a').click(function(e) {
    $('html, body').animate({
      scrollTop: $($(this).attr('href')).offset().top - 82
    }, 1500);
    return false;
  });
  $(document).on('scroll', function() {
    if ($(document).scrollTop() < position.offset().top + position.height()) {
      return $("#main-menu").removeClass('fixed');
    } else {
      return $("#main-menu").addClass('fixed');
    }
  });
  lock = false;
  $(window).bind('load resize', function() {
    if ((matchMedia('all and (max-width: 970px)').matches)) {
      if ($('.nav.menu').is(':visible')) {
        if (!lock) {
          $('.nav.menu').hide();
          lock = true;
        }
      }
    } else {
      if ($('.nav.menu').is(':hidden')) {
        $('.nav.menu').show();
      }
      lock = false;
    }
  });
  $('#navigation-dropdown').on('click', function() {
    $('#main-header-link').hide();
    $(this).toggleClass('active');
    if ($('.nav.menu').is(':visible')) {
      $('#main-header-link').hide();
      $('.nav.menu').slideUp();
    } else {
      $('.nav.menu').slideDown();
      $('#main-header-link').fadeIn(1000);
    }
  });
  slider = $('.bxslider').bxSlider({
    controls: false,
    pager: false
  });
  $('#web .more').click(function(e) {
    e.preventDefault();
    lock_scroll();
    slider.goToSlide($(this).data('slide'));
  });
  $('.backToFirstSlide').click(function(e) {
    slider.goToSlide(0);
    e.preventDefault();
    unlock_scroll();
  });
});

lock_scroll = function() {
  var html, scrollPosition;
  $('html, body').animate({
    scrollTop: $($('.nav li a').eq(1).attr('href')).offset().top - 82
  }, 1500);
  scrollPosition = [self.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft, self.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop];
  html = jQuery('body');
  html.data('scroll-position', scrollPosition);
  html.data('previous-overflow', html.css('overflow'));
  html.css('overflow', 'hidden');
  return window.scrollTo(scrollPosition[0], scrollPosition[1]);
};

unlock_scroll = function() {
  var html, scrollPosition;
  html = jQuery('body');
  scrollPosition = html.data('scroll-position') ? html.data('scroll-position') : [0, 0];
  html.css('overflow', html.data('previous-overflow'));
  return $('html, body').animate({
    scrollTop: $($('.nav li a').eq(1).attr('href')).offset().top - 82
  }, 1500);
};
